{"ast":null,"code":"var _jsxFileName = \"/Users/rhopperlowe/Desktop/School/Spring 2020/Spring2020_workspace/bank/bank-frontend/src/pages/signup/SignupPage.jsx\";\nimport React, { useContext, useState, useCallback, useEffect } from 'react';\nimport { Container, MaskedPinInput } from '../../common/StyleClasses';\nimport { Card } from 'baseui/card';\nimport { FormControl } from 'baseui/form-control';\nimport { Input } from 'baseui/input';\nimport { PinCode } from 'baseui/pin-code';\nimport AppContext from '../../context/AppContext';\nimport { useHistory } from 'react-router-dom';\nimport { Button } from 'baseui/button';\nimport { userSignup, userLogin } from '../../backend/api';\nimport ErrorBox from '../../common/ErrorBox';\nimport { authLogin } from '../../reducers/authReducer';\n\nconst SignupPage = () => {\n  const {\n    setError,\n    authDis,\n    appErr\n  } = useContext(AppContext);\n  const history = useHistory();\n  const [username, setUsername] = useState('');\n  const [pin, setPin] = useState([\"\", \"\", \"\", \"\"]);\n  const [confirmPin, setConfirmPin] = useState([\"\", \"\", \"\", \"\"]);\n  const [negativePinCode, setNegativePinCode] = useState(false);\n  const [userTaken, setUserTaken] = useState(false);\n  const checkPinsMatch = useCallback(() => {\n    if (pin[0] === \"\" || confirmPin[0] === \"\") {\n      return false;\n    }\n\n    for (let i in pin) {\n      if (parseInt(pin[i]) !== parseInt(confirmPin[i])) {\n        return false;\n      }\n    }\n\n    return pin.length === confirmPin.length;\n  }, [pin, confirmPin]);\n  useEffect(() => {\n    setNegativePinCode(!checkPinsMatch());\n  }, [confirmPin]);\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }, \"Sign Up\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: e => {\n      e.preventDefault();\n\n      if (username.length < 4) {\n        setError(\"Invalid Username\");\n        return false;\n      }\n\n      if (pin.join().length !== 4) {\n        console.log(pin.join(\"\"));\n        setError(\"Invalid Pin\");\n        return false;\n      }\n\n      if (!checkPinsMatch()) {\n        setError(\"Pins do not match\");\n        return false;\n      }\n\n      userSignup(username, parseInt(pin.join(\"\"))).then(({\n        user: newUser\n      }) => {\n        console.log(\"User \" + newUser.id + \" successfully created!\");\n        userLogin(newUser.username, newUser.pin).then(({\n          user\n        }) => {\n          console.log(\"User \" + user.id + \" (\" + user.username + \") login success!\");\n          authDis(authLogin(user));\n          history.push(\"/\");\n        });\n      }).catch(error => {\n        setError(error.message);\n        setUserTaken(true);\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FormControl, {\n    label: () => \"Username:\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: username,\n    onChange: e => {\n      setUsername(e.target.value);\n      setUserTaken(false);\n    },\n    error: userTaken,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(FormControl, {\n    label: () => \"Pin:\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(PinCode, {\n    values: pin,\n    onChange: ({\n      values\n    }) => setPin(values),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(FormControl, {\n    label: () => \"Confirm Pin:\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(PinCode, {\n    values: confirmPin,\n    onChange: ({\n      values\n    }) => setConfirmPin(values),\n    error: negativePinCode && confirmPin[0] !== \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(ErrorBox, {\n    error: appErr,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, \"Submit\"))));\n};\n\nexport default SignupPage;","map":{"version":3,"sources":["/Users/rhopperlowe/Desktop/School/Spring 2020/Spring2020_workspace/bank/bank-frontend/src/pages/signup/SignupPage.jsx"],"names":["React","useContext","useState","useCallback","useEffect","Container","MaskedPinInput","Card","FormControl","Input","PinCode","AppContext","useHistory","Button","userSignup","userLogin","ErrorBox","authLogin","SignupPage","setError","authDis","appErr","history","username","setUsername","pin","setPin","confirmPin","setConfirmPin","negativePinCode","setNegativePinCode","userTaken","setUserTaken","checkPinsMatch","i","parseInt","length","e","preventDefault","join","console","log","then","user","newUser","id","push","catch","error","message","target","value","values"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useCallback, useEffect } from 'react';\nimport { Container, MaskedPinInput } from '../../common/StyleClasses';\nimport { Card } from 'baseui/card';\nimport { FormControl } from 'baseui/form-control';\nimport { Input } from 'baseui/input';\nimport { PinCode } from 'baseui/pin-code';\nimport AppContext from '../../context/AppContext';\nimport { useHistory } from 'react-router-dom';\nimport { Button } from 'baseui/button';\nimport { userSignup, userLogin } from '../../backend/api';\nimport ErrorBox from '../../common/ErrorBox';\nimport { authLogin } from '../../reducers/authReducer';\n\nconst SignupPage = () => {\n  const { setError, authDis, appErr } = useContext(AppContext);\n  const history = useHistory();\n  const [username, setUsername] = useState('');\n  const [pin, setPin] = useState([\"\", \"\", \"\", \"\"]);\n  const [confirmPin, setConfirmPin] = useState([\"\", \"\", \"\", \"\"]);\n  const [negativePinCode, setNegativePinCode] = useState(false);\n  const [userTaken, setUserTaken] = useState(false);\n\n  const checkPinsMatch = useCallback(\n    () => {\n      if (pin[0] === \"\" || confirmPin[0] === \"\") {\n        return false;\n      }\n\n      for (let i in pin) {\n        if (parseInt(pin[i]) !== parseInt(confirmPin[i])) {\n          return false;\n        }\n      }\n      return pin.length === confirmPin.length;\n    },\n    [pin, confirmPin],\n  );\n\n  useEffect(() => {\n    setNegativePinCode(!checkPinsMatch());\n  }, [confirmPin])\n\n  return (\n    <Container>\n      <Card>\n        <h2>Sign Up</h2>\n        <form onSubmit={(e) => {\n          e.preventDefault();\n\n          if (username.length < 4) {\n            setError(\"Invalid Username\");\n            return false;\n          }\n\n          if (pin.join().length !== 4) {\n            console.log(pin.join(\"\"));\n            \n            setError(\"Invalid Pin\");\n            return false;\n          }\n\n          if (!checkPinsMatch()) {\n            setError(\"Pins do not match\");\n            return false;\n          }\n\n          userSignup(username, parseInt(pin.join(\"\")))\n          .then(({ user: newUser }) => {\n            console.log(\"User \" + newUser.id + \" successfully created!\");\n\n            userLogin(newUser.username, newUser.pin)\n            .then(({ user }) => {\n              console.log(\"User \" + user.id + \" (\" + user.username + \") login success!\");\n              authDis(authLogin(user));\n              history.push(\"/\");\n            })\n          })\n          .catch(error => {\n            setError(error.message);\n            setUserTaken(true);\n          })\n        }}>\n          <FormControl\n            label={() => \"Username:\"}\n          >\n            <Input\n              value={username}\n              onChange={(e) => {\n                setUsername(e.target.value)\n                setUserTaken(false);\n              }}\n              error={userTaken}\n            />\n          </FormControl>\n\n          <FormControl\n            label={() => \"Pin:\"}\n          >\n            <PinCode\n              values={pin}\n              onChange={({ values }) => setPin(values)}\n            />\n          </FormControl>\n\n          <FormControl\n            label={() => \"Confirm Pin:\"}\n          >\n            <PinCode\n              values={confirmPin}\n              onChange={({ values }) => setConfirmPin(values)}\n              error={negativePinCode && confirmPin[0] !== \"\"}\n            />\n          </FormControl>\n          \n          <ErrorBox error={appErr} />\n\n          <Button>Submit</Button>\n        </form>\n      </Card>\n    </Container>\n  );\n};\n\nexport default SignupPage;"]},"metadata":{},"sourceType":"module"}