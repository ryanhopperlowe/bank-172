{"ast":null,"code":"import _slicedToArray from\"/Users/rhopperlowe/Desktop/School/Spring 2020/Spring2020_workspace/bank/bank-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useCallback,useEffect}from'react';import{Container}from'../../common/StyleClasses';import{Card}from'baseui/card';import{FormControl}from'baseui/form-control';import{Input}from'baseui/input';import{PinCode}from'baseui/pin-code';import AppContext from'../../context/AppContext';import{useHistory}from'react-router-dom';import{Button}from'baseui/button';import{userSignup,userLogin}from'../../backend/api';import ErrorBox from'../../common/ErrorBox';import{authLogin}from'../../reducers/authReducer';var SignupPage=function SignupPage(){var _useContext=useContext(AppContext),setError=_useContext.setError,authDis=_useContext.authDis,appErr=_useContext.appErr;var history=useHistory();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState([\"\",\"\",\"\",\"\"]),_useState4=_slicedToArray(_useState3,2),pin=_useState4[0],setPin=_useState4[1];var _useState5=useState([\"\",\"\",\"\",\"\"]),_useState6=_slicedToArray(_useState5,2),confirmPin=_useState6[0],setConfirmPin=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),negativePinCode=_useState8[0],setNegativePinCode=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),userTaken=_useState10[0],setUserTaken=_useState10[1];var checkPinsMatch=useCallback(function(){if(pin[0]===\"\"||confirmPin[0]===\"\"){return false;}for(var i in pin){if(parseInt(pin[i])!==parseInt(confirmPin[i])){return false;}}return pin.length===confirmPin.length;},[pin,confirmPin]);useEffect(function(){setNegativePinCode(!checkPinsMatch());},[confirmPin,checkPinsMatch]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Sign Up\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();if(username.length<4){setError(\"Invalid Username\");return false;}if(pin.join('').length<4){console.log(pin.join(\"\"));setError(\"Invalid Pin\");return false;}if(!checkPinsMatch()){setError(\"Pins do not match\");return false;}userSignup(username,parseInt(pin.join(\"\"))).then(function(_ref){var newUser=_ref.user;console.log(\"User \"+newUser.id+\" successfully created!\");userLogin(newUser.username,newUser.pin).then(function(_ref2){var user=_ref2.user;console.log(\"User \"+user.id+\" (\"+user.username+\") login success!\");authDis(authLogin(user));history.push(\"/\");});}).catch(function(error){setError(error.message);setUserTaken(true);});}},/*#__PURE__*/React.createElement(FormControl,{label:function label(){return\"Username:\";}},/*#__PURE__*/React.createElement(Input,{value:username,onChange:function onChange(e){setUsername(e.target.value);setUserTaken(false);},error:userTaken})),/*#__PURE__*/React.createElement(FormControl,{label:function label(){return\"Pin:\";}},/*#__PURE__*/React.createElement(PinCode,{values:pin,onChange:function onChange(_ref3){var values=_ref3.values;return setPin(values);}})),/*#__PURE__*/React.createElement(FormControl,{label:function label(){return\"Confirm Pin:\";}},/*#__PURE__*/React.createElement(PinCode,{values:confirmPin,onChange:function onChange(_ref4){var values=_ref4.values;return setConfirmPin(values);},error:negativePinCode&&confirmPin[0]!==\"\"})),/*#__PURE__*/React.createElement(ErrorBox,{error:appErr}),/*#__PURE__*/React.createElement(Button,null,\"Submit\"))));};export default SignupPage;","map":{"version":3,"sources":["/Users/rhopperlowe/Desktop/School/Spring 2020/Spring2020_workspace/bank/bank-frontend/src/pages/signup/SignupPage.jsx"],"names":["React","useContext","useState","useCallback","useEffect","Container","Card","FormControl","Input","PinCode","AppContext","useHistory","Button","userSignup","userLogin","ErrorBox","authLogin","SignupPage","setError","authDis","appErr","history","username","setUsername","pin","setPin","confirmPin","setConfirmPin","negativePinCode","setNegativePinCode","userTaken","setUserTaken","checkPinsMatch","i","parseInt","length","e","preventDefault","join","console","log","then","newUser","user","id","push","catch","error","message","target","value","values"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useCallback, useEffect } from 'react';\nimport { Container } from '../../common/StyleClasses';\nimport { Card } from 'baseui/card';\nimport { FormControl } from 'baseui/form-control';\nimport { Input } from 'baseui/input';\nimport { PinCode } from 'baseui/pin-code';\nimport AppContext from '../../context/AppContext';\nimport { useHistory } from 'react-router-dom';\nimport { Button } from 'baseui/button';\nimport { userSignup, userLogin } from '../../backend/api';\nimport ErrorBox from '../../common/ErrorBox';\nimport { authLogin } from '../../reducers/authReducer';\n\nconst SignupPage = () => {\n  const { setError, authDis, appErr } = useContext(AppContext);\n  const history = useHistory();\n  const [username, setUsername] = useState('');\n  const [pin, setPin] = useState([\"\", \"\", \"\", \"\"]);\n  const [confirmPin, setConfirmPin] = useState([\"\", \"\", \"\", \"\"]);\n  const [negativePinCode, setNegativePinCode] = useState(false);\n  const [userTaken, setUserTaken] = useState(false);\n\n  const checkPinsMatch = useCallback(\n    () => {\n      if (pin[0] === \"\" || confirmPin[0] === \"\") {\n        return false;\n      }\n\n      for (let i in pin) {\n        if (parseInt(pin[i]) !== parseInt(confirmPin[i])) {\n          return false;\n        }\n      }\n      return pin.length === confirmPin.length;\n    },\n    [pin, confirmPin],\n  );\n\n  useEffect(() => {\n    setNegativePinCode(!checkPinsMatch());\n  }, [confirmPin, checkPinsMatch])\n\n  return (\n    <Container>\n      <Card>\n        <h2>Sign Up</h2>\n        <form onSubmit={(e) => {\n          e.preventDefault();\n\n          if (username.length < 4) {\n            setError(\"Invalid Username\");\n            return false;\n          }\n\n          if (pin.join('').length < 4) {\n            console.log(pin.join(\"\"));\n            \n            setError(\"Invalid Pin\");\n            return false;\n          }\n\n          if (!checkPinsMatch()) {\n            setError(\"Pins do not match\");\n            return false;\n          }\n\n          userSignup(username, parseInt(pin.join(\"\")))\n          .then(({ user: newUser }) => {\n            console.log(\"User \" + newUser.id + \" successfully created!\");\n\n            userLogin(newUser.username, newUser.pin)\n            .then(({ user }) => {\n              console.log(\"User \" + user.id + \" (\" + user.username + \") login success!\");\n              authDis(authLogin(user));\n              history.push(\"/\");\n            })\n          })\n          .catch(error => {\n            setError(error.message);\n            setUserTaken(true);\n          })\n        }}>\n          <FormControl\n            label={() => \"Username:\"}\n          >\n            <Input\n              value={username}\n              onChange={(e) => {\n                setUsername(e.target.value)\n                setUserTaken(false);\n              }}\n              error={userTaken}\n            />\n          </FormControl>\n\n          <FormControl\n            label={() => \"Pin:\"}\n          >\n            <PinCode\n              values={pin}\n              onChange={({ values }) => setPin(values)}\n            />\n          </FormControl>\n\n          <FormControl\n            label={() => \"Confirm Pin:\"}\n          >\n            <PinCode\n              values={confirmPin}\n              onChange={({ values }) => setConfirmPin(values)}\n              error={negativePinCode && confirmPin[0] !== \"\"}\n            />\n          </FormControl>\n          \n          <ErrorBox error={appErr} />\n\n          <Button>Submit</Button>\n        </form>\n      </Card>\n    </Container>\n  );\n};\n\nexport default SignupPage;"]},"metadata":{},"sourceType":"module"}